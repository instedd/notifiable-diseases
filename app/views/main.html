<nd-reports-navbar></nd-reports-navbar>

<div class="row report" ng-show="currentReport">
  <div class="col-md-12" style="margin-bottom:20px">
    <h3 style="margin-top:0">
      <a href="#" editable-text="currentReport.name">{{currentReport.name}}</a>
    </h3>
    <div>
      <a href="#" editable-textarea="currentReport.description" e-rows="4" e-cols="60">{{currentReport.description || 'No description'}}</a>
    </div>
  </div>

  <!-- BEGIN: Filters panel -->
  <div id="filters" class="col-md-3" ng-controller="FiltersCtrl">
    <div class="well white out condensed">
      <div class="row">
        <div class="col-md-6">
          <strong style="font-size:16px">Filters</strong>
        </div>
        <div class="col-md-6">
          <a class="pull-right" href="javascript:void(0)" ng-click="clearFilters()" ng-show="currentReport.filters.length > 0">
            Clear all
          </a>
        </div>
      </div>
      <hr/>
      <div>
        <strong>All cases</strong>
      </div>
      <div ng-repeat="filter in currentReport.filters">
        <hr/>
        <div class="row">
          <div class="col-md-6">
            <strong>{{ filter.description }}</strong>
          </div>
          <div class="col-md-6">
            <a class="pull-right" href="javascript:void(0)" ng-click="$parent.removeFilterByIndex($index)">remove</a>
          </div>
        </div>
        <div ng-include src="filterTemplateFor(filter)"></div>
      </div>
      <hr/>
      <div>
        <a href="javascript:void(0);" ng-click="addNewFilterIsCollapsed = !addNewFilterIsCollapsed">Add new filter</a>
        <div collapse="addNewFilterIsCollapsed">
          <ul>
            <li><a href="javascript:void(0);" ng-click="addFilter('DateFilter')">Date</a></li>
            <li><a href="javascript:void(0);" ng-click="addFilter('EthnicityFilter')">Ethnicity</a></li>
            <li><a href="javascript:void(0);" ng-click="addFilter('GenderFilter')">Gender</a></li>
          </ul>
        </div>
      </div>
    </div>
    <a href="javascript:void(0);" ng-click="duplicateReport()">Duplicate this report</a>
    <br/>
    <a href="javascript:void(0);" ng-click="deleteReport()">Delete this report</a>
  </div>
  <!-- END: Filters panel -->

  <!-- BEGIN: Charts -->
  <div class="col-md-7" ng-controller="ChartsCtrl">
    <div class="row" ng-repeat="chart in currentReport.charts">
      <div class='col-md-11'>
        <div class='nd-trendline well row' ng-controller="ChartCtrl" ng-init="chart=chart;report=currentReport" style="min-height:480px;max-height:480px">
          <div ng-hide="editingChart">
            <div class="pull-left">
              <a href="javascript:void(0)" ng-click="edit()">edit</a>
            </div>
            <div class="pull-right">
              <a href="javascript:void(0)" ng-click="$parent.removeChartByIndex($index)">remove</a>
            </div>
            <div ng-include src="chartTemplateFor(chart)"></div>
          </div>
          <div ng-show="editingChart">
            <form ng-submit="saveChanges()">
              <div ng-include src="chartConfigTemplateFor(chart)"></div>
              <div style="margin-top:20px">
                <button class="btn btn-primary" ng-click="saveChanges()">Done</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <div>
      <a href="javascript:void(0);" ng-click="addNewChartIsCollapsed = !addNewChartIsCollapsed">+ Add new visualization</a>
      <div collapse="addNewChartIsCollapsed">
        <ul>
          <li><a href="javascript:void(0);" ng-click="addChart('Trendline')">Trendline</a></li>
        </ul>
      </div>
    </div>
  </div>
  <!-- END: Charts -->
</div>
